- используем курсор для оптимизации и ускорения
- рефакторим каждый метод
- подумать, как корректно отдавать задачу cursor и выдавать ему контекст
- тесты 